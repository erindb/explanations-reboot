---
title: "All booleans! Vary structure!"
author: "Erin Bennett"
output: 
  html_document:
      toc: false
bibliography: "../../explanations.bib"
---

```{r global_options, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo=F, warning=F, cache=T, message=F, sanitiz =T, fig.width = 5, fig.height = 3)
```

```{r load_settings}
# install.packages('devtools')
# devtools::install_github("mhtess/rwebppl")
source("~/Settings/startup.R")
library(reshape2)
```

## 1. Using only boolean variables, do counterfactual probabilities match up with L&K's model?

Yep.

```{r}
counterfactual = function(variable, storynumber, premise.variable, premise.value) {
  program_file = paste("rsa.base.booleans/lk", storynumber,
                       "/autoexpanded.wppl", sep="")
  rs = webppl(program_file = program_file,
         inference_opts = list(method="enumerate"),
         model_var = paste(
           "function() {return counterfactual(0.53, {'",
           premise.variable,
           "': ",
           ifelse(premise.value, "true", "false"),
           "});}",
           sep=""),
         packages = "./node_modules/jsUtils")
  return(sum(rs[rs[[variable]]==T, "prob"]))
}

lk.model = read.csv("lk-model-data-numbers.csv") %>%
  mutate(my.model = mapply(counterfactual, variable,
                           story, premise.variable, premise.value),
         story = factor(story))

lk.model %>% ggplot(., aes(x=rating, y=my.model, colour=story)) +
  geom_point()
```

## 2. What happens when we introduce structural uncertainty for *one* link?

## 3. How do explanations compare with and without uncertainty about one link?

<!-- # References -->